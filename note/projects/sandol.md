# 한국산업기술대학교 챗봇 산돌이 개발
- 2019.01 ~
- 산돌팀 총괄 및 경영
- [여기](https://pf.kakao.com/_pRxlZxb)를 클릭하세요. 바로 산돌이와 대화할 수 있습니다.

## 챗봇은 우리의 삶을 바꿀 수 있을까?
- 때는 19년 1월, 계절학기 AI 특강에서 챗봇에 대한 묘한 이끌림을 받았었다. 이 이끌림은 Mindlogic이라는 회사에서 오신 강사님이 자신의 연구 도메인에 대해서 설명하는 그 찰나의 순간에 발생했다.
- 자신은 연인 컨셉의 대화형 인공지능을 연구하고 있으며, 이는 세상을 의미있고 재밌게 바꿀 것이라고 역설하는 것을 보며 세상에는 이런 멋지고 영화에나 나올법한 연구를 하는 사람도 있구나 하는 생각이 들었던 것 같다.
- 그 날 저녁, 우연치 않게 들어간 교내 에브리타임에서 발견한 글 때문에 이 프로젝트가 시작되었다. 기존에 학우들이 사용하던 카카오톡 기반의 학식 챗봇이 카카오의 API 규제로 기능이 정지되어 새롭게 챗봇을 개발해줄 사람을 찾는다고 식당 아주머니가 글을 올린 것이었다. 물론 무보수로 말이다.
- 정말 아무것도 몰랐지만 곧장 지원을 했다. Response가 안되는 것일테니 해당 부분만 보수하거나 다른 방식으로 카카오 서버로 보내면 될 것이라고 생각했기 때문이다. 물론 AI인지 뭐시기를 넣어서 자비스같은 멋진 녀석으로 개조해보고 학우들의 사용자 경험을 보고 싶다는 생각도 있었다.
- 그러나 졸업자셨던 기존 챗봇 개발자 선배님과 대화를 나누면서 이러한 생각은 모두 걱정과 근심이 되었다. 좋은 일을 무보수로 하는거니까... 기존 코드나 도커 이미지라도 받을 수 있을 것이라고 생각했는데... 줄 수 없다는 것이었다... 추가적으로 아예 카카오 자체 빌더가 생기면서 이제부터 카카오톡 챗봇은 무조건 해당 빌더를 이용해야 한다고 했다.
- 결론부터 말하면 한 달만에 구현에 성공해서 학우들에게 서비스를 시작했다. 지금 생각해보면 아무것도 모르던 내가 어떻게 뚝딱 만들어서 배포했었는지 참으로 신기하다. 졸업을 앞 둔 지금은 앞으로 내가 없더라도 산돌이를 추가적으로 개선하고 관리할 수 있도록 능력자 후배님들을 모셔서 산돌팀을 결성했다. Github Actions기반의 CI/CD Pipeline을 구현해두어서 산돌이의 백엔드와 스킬 코드를 모두가 볼 수 있다. 해당 레포지토리는 [여기](https://github.com/hhhminme/kpu_sandol_team)에서 볼 수 있다.

<p align = 'center'>
  <img src = "https://github.com/koptimizer/description/blob/main/note/projects/pics/sandol1.jpg"><br/>
  (현재도 잘 서비스되고 있는 산돌이의 모습)
  </br>
</p>
<br/>

## 무작정 서울로 갔다
- 당시 카카오 자체 챗봇 빌더인 카카오 i 오픈 빌더가 출시된지 얼마 안되었을 때라서 자료도 매우 없었다. 자료를 쥐잡듯이 뒤지다가 페이스북의 챗봇 커뮤니티까지 오게되었는데, 서울에서 Dialogflow를 이용헌 챗봇 개발 세미나를 연다는 소식에 냅다 달려가서 세미나를 들었다.
- 그러다가 참 귀한 분이랑 인연이 닿기도 했었다. 내 옆에 앉았던 선생님이 세미나 따라가는 것에 어려움이 많으셔서 많은 도움을 드렸었는데, 알고보니 한의학 전공이시자 AI에 관심이 많으신 교수님이셨던 것이다.(ㅎㄷㄷ) 지금도 연락을 잘 주고받으면서 NLP관련된 이야기를 나누곤 한다.
- 쨋든 어느정도 감을 익힌 후에 본격적으로 개발에 착수했다. 물론 챗봇의 기획과 디자인까지 모두 혼자 진행했다. 개발에서 가장 주요한 테스크는 웹 크롤링과 스킬 서버 연동이었는데, 이 중에서 스킬 서버 연동에서 어려움이 많았던 것으로 기억한다.

## 산 너머 산, 스킬 서버 연동
- AWS를 이 때에 처음 접했다. 프리티어로 계정을 파고, EC2 위에서 Django 웹서버 기반으로 스킬 서버를 구성하였다. 그나마 파이썬이랑 웹을 어느정도 다룰 줄 알았던게 다행이었다.
  - 이 때 크게 곤욕을 치뤘던 것은... AWS의 Gateway나 RDB같은 용어들을 잘 몰라서 한 스텝의 전진을 하기 위해 1시간씩 구글을 뒤졌었다.
  - 그리고 뭐 제대로 구축된 환경도 없이 AWS 웹사이트에서 냅다 코딩을 하고 테스트를 했었는데, 사이트가 불안정해서 코드가 날라가거나 에러가 발생해도 어디서 에러를 확인하는지 모르는 등의 삽질의 연속을 겪었었다.
- 그래도 기능적으로 나름 만족스럽게 완성을 했다. 
  - 학식 아주머니의 카카오톡 고유 ID를 받아서 해당 ID가 인식되면 학식 입력 UI를 호출하게 하였고, 이외의 ID일 경우에는 학식을 받아볼 수 있게 하였다.
  - 추가적으로 전국 날씨와 학사 공지사항과 같은 기본 정보도 열람할 수 있게 하였고, 지하철 관련 API를 연동해서 실시간으로 학교 근처 역의 지하철 현황을 받아볼 수 있게 하였다.
  - 교내 시설과 번호 조회, 셔틀 시간표나 막차시간은 자주 바뀌는 항목이 아니기 때문에 하드코딩을 해주었다.

## 첫 배포와 이슈
- 다행히 개발 이후 배포까지 잘 완료했지만, 대학 특성상 주말과 방학에는 이용률이 낮음에도 서버는 똑같이 돌아서 비슷한 사용량이 나오기 때문에 과금에 대한 불안감이 생겼다. 물론 소액이긴 했어도 무보수로 개발하면서 과금되는 건 억울하니까...
- 그래서 서버리스로 백엔드를 완전히 틀었다. 찾아보니까 Lambda라고 하는 함수 형식의 서버리스 아키텍쳐를 AWS에서 지원해주고 있어서 Lambda로 모든 코드를 전환시켰다. 속도는 살짝 느려진 느낌이지만, 트래픽은 확실하게 낮아져서 이슈를 해결할 수 있었다.
- 또, 사용률이 조금 낮다고 생각해서 홍보나 외부 식당 영업도 내 발로 직접 뛰었다. 물론 기능이 좋아야 사람들이 오래 이용할 것이기 때문에 다양한 기능들을 추가했다.

<p align = 'center'>
  <img src = "https://github.com/koptimizer/description/blob/main/note/projects/pics/sandol2.jpg"><br/>
  (산돌이의 초기 스킬 백엔드였던 Lambda 함수... 지금은 CI/CD를 연동할 수 있도록 새로 팠기 때문에 비활성화 해둔 상태이다.)
  </br>
  <img src = "https://github.com/koptimizer/description/blob/main/note/projects/pics/sandol3.jpg"><br/>
  (지금보면 참 부끄럽지만 캐릭터 디자인과 페르소나, 홍보물까지 직접 만들었다.)
  </br>
</p>
<br/>

## 앞으로 산돌이의 로드맵
- 솔직히 기능적으로는 이제 흠잡을 곳이 없다. 그러나 지속가능한 챗봇으로 굴리기 위해서는 반드시 수익창출이 이루어져야하기 때문에 광고를 달기로 했고, 광고주를 모시기 위해 영업이 가능한 후배를 산돌팀으로 추가 섭외했다. 빠르면 8월 중에 시작할 것 같은데... 원활하게 하려면 사업자도 등록해야한다고 한다. 솔직히 이건 좀 귀찮...
- 산돌이에 최종적으로 추가하고 싶은 기능은 열린 주제의 대화형 인공지능이다. 마치 심심이나 이루다처럼! 그래서 BERT기반의 문장 생성에 대해서도 연구하고 있고, 이러한 거대한 언어 모델을 서버 상에 어떻게 올릴 것이며 어떻게 쾌적하게 연동할 것인가에 대한 고민도 남아있다. 아직 한 학기나 남았으니까 이번에도 기적처럼 잘 해내리라고 미래의 나를 믿고 있다 ㅎㅎ...

## 그래서 산돌이는 학생들의 삶을 바꾸었나?
- 그렇다. 매우 그렇다. 내 피조물에 대해서 애착이 있어서가 아니라 잘 만들어진 챗봇이 얼마나 사용자 경험을 경이롭게 바꾸는지 잘 알 수 있는 프로젝트였다. 
- 현재 구독자는 2000명 가량이고 학기 평일을 기준으로 하루 평균 400회의 호출을 받는다. 교내에서도 이미 유명해서 행정 선생님들도 산돌이를 잘 알고 있고, 학보사에서 인터뷰를 받은적 있었다. 학생들이 잘 이용하는 피드백을 보면서 너무나도 큰 보람을 느낀다.

<p align = 'center'>
  <img src = "https://github.com/koptimizer/description/blob/main/note/projects/pics/sandol4.jpg"><br/>
  (2021년 1학기 기준 일 평균 400회 호출)
  </br>
  <img src = "https://github.com/koptimizer/description/blob/main/note/projects/pics/sandol5.jpg"><br/>
  (본교 학보 490호 6면에 소개된 산돌이)
  </br>
</p>
<br/>
